# Petya

## Introduction

### A short Petya history
Petya is a family of encrypting malware that was first discovered in 2016. The malware targets Microsoft Windowsâ€“based systems, infecting the master boot record to execute a payload that encrypts a hard drive's file system table and prevents Windows from booting. It subsequently demands that the user make a payment in Bitcoin in order to regain access to the system.

Variants of Petya were first seen in March 2016, which propagated via infected e-mail attachments. In June 2017, a new variant of Petya was used for a global cyberattack, primarily targeting Ukraine. The new variant propagates via the EternalBlue exploit, which is generally believed to have been developed by the U.S. National Security Agency (NSA), and was used earlier in the year by the WannaCry ransomware.

Kaspersky Lab referred to this new version as NotPetya to distinguish it from the 2016 variants, due to these differences in operation. It looked like ransomware, but without functioning recovery feature it was equivalent to a wiper. The NotPetya attacks have been blamed on the Russian government, specifically the Sandworm hacking group within the GRU Russian military intelligence organization, by security researchers, Google, and several governments.

As always, more information can be found in [this wikipedia page](https://en.wikipedia.org/wiki/Petya_and_NotPetya).

### Malware files
-   4c1dc737915d76b7ce579abddaba74ead6fdb5b519a1ea45308b8c49b950655c.exe (Petya)
-   2a2a4e8ac8a25f27a49b5f25d4af953050474f468d32540f1e2a0f7e81f67556.exe (Green Petya)
-   389a7d395492c2da6f8abf5a8a7c49c3482f7844f77fe681808c71e961bcae97.exe (Golden Eye)

I did not include NotPetya (or Netya, EternalPetya), because it's not an official version of the malware.
However, I did reverse engineered this malware too, you can look it [here](https://github.com/Natisfaction/Reverse_Malware/NotPetya).

### My files
-   *.json (OOAnalyzer generated files)
-   *.bin (Bytes written into the disk by the malware)

## 4c1dc737915d76b7ce579abddaba74ead6fdb5b519a1ea45308b8c49b950655c.exe
This is the first original Petya ransomware.

### Behavior
...

At system reboot, there will be a fake CHKDSK screen, in reality this is the malware MBR payload encrypting the MFT.
![FakeCHKSDK](https://github.com/Natisfaction/Reverse_Malware/blob/main/Petya/README_IMAGES/FakeCHKDSK.png)

### MBR Payload
I'll try to reverse engineer the malware payload as soon as I can.

After the fake CHKSDK screen, those will be the ransom notes:
![PetyaFinal](https://github.com/Natisfaction/Reverse_Malware/blob/main/Petya/README_IMAGES/PetyaFinal.png)

## 2a2a4e8ac8a25f27a49b5f25d4af953050474f468d32540f1e2a0f7e81f67556.exe
This is the Green Petya ransonmware variant.

### Behavior
There is not much to say about this malware, you can probably tell what it does by yourself looking at the image:
![Green Petya code](https://github.com/Natisfaction/Reverse_Malware/blob/main/Petya/README_IMAGES/GreenPetyaCode.png)

At system reboot, there will be a fake CHKDSK screen, in reality this is the malware MBR payload encrypting the MFT.
![FakeCHKSDK](https://github.com/Natisfaction/Reverse_Malware/blob/main/Petya/README_IMAGES/FakeCHKDSK.png)

### MBR Payload
I'll try to reverse engineer the malware payload as soon as I can.

After the fake CHKDSK check screen, the main ransom window will appear:
![GreenPetyaFinal](https://github.com/Natisfaction/Reverse_Malware/blob/main/Petya/README_IMAGES/GreenPetyaFinal.png)

## 389a7d395492c2da6f8abf5a8a7c49c3482f7844f77fe681808c71e961bcae97.exe
This is the GoldenEye Petya ransomware variant.

### Behavior
I'll try to reverse engineer the malware payload as soon as I can.

At system reboot, there will be a fake CHKDSK screen, in reality this is the malware MBR payload encrypting the MFT.
![FakeCHKSDK](https://github.com/Natisfaction/Reverse_Malware/blob/main/Petya/README_IMAGES/FakeCHKDSK.png)

### MBR Payload
I'll try to reverse engineer the malware payload as soon as I can.

After the fake CHKSDK text, this is the window that will appear:
![GoldenEyeFinal](https://github.com/Natisfaction/Reverse_Malware/blob/main/Petya/README_IMAGES/GoldenEyeFinal.png)